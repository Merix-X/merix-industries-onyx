<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onyx AI Console</title>
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Onyx AI Console</h1>
    
    <div class="console">
        <textarea id="console-output" rows="10" cols="50" readonly></textarea>
    </div>

    <input type="text" id="user-input" placeholder="Type your message...">
    <button id="send-button">Send</button>

    <py-script>
import js
import asyncio
import json
from pyodide.http import pyfetch

async def send_query():
    user_input = js.document.getElementById("user-input").value
    if not user_input:
        return

    url = "https://onyx.merix-industries.com/ask"  # ZMĚŇTE na skutečný server
    headers = {"Content-Type": "application/json"}
    data = json.dumps({"query": user_input})

    response = await pyfetch(url, method="POST", headers=headers, body=data)
    result = await response.json()
    
    output_area = js.document.getElementById("console-output")
    output_area.value += f"\nYou: {user_input}\nAI: {result['response']}\n"
    js.document.getElementById("user-input").value = ""

# Napojení tlačítka na funkci
js.document.getElementById("send-button").addEventListener("click", lambda event: asyncio.ensure_future(send_query()))
    </py-script>

</body>
</html>
